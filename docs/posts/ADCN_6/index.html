<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Brad Stenger">
<meta name="dcterms.date" content="2025-12-17">

<title>ADCN: Biomarkers, Player Tracking Viz, Womens Update – newsletter</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-a37c72dd2dbac68997fcdc15a3622e78.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-2e2a78c07a477a1d763148e43113f08b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">newsletter</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">Brad Stenger</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">ADCN: Biomarkers, Player Tracking Viz, Womens Update</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Brad Stenger </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">December 17, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar"><div class="quarto-margin-header"><div class="margin-header-item">
<div style="height:290">
    <iframe src="https://cdn.forms-content.sg-form.com/ed8875f7-7972-11f0-ad55-92cd5bc3b37f" width="340" height="300" scrolling="no"></iframe>
</div>

</div></div>
        
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="biomarkers" class="level3">
<h3 class="anchored" data-anchor-id="biomarkers">Biomarkers</h3>
<p>A report in The Athletic <a href="https://www.nytimes.com/athletic/6858367/2025/12/05/soccer-saliva-marginal-gains/">described</a> new saliva-sampling analysis technology that is gaining customers among European soccer teams. <a href="https://www.biolyz.com/">Biolyz</a> is a startup company based in Austria that has biosampling and transport methods to rapidly process saliva in order to quantify the athlete-relevant biomarkers using mass spectrometry, a very effective technology for separating and identifying molecules in a biological sample. The collect-send-report process is a step back from the wearable biomarker identification that has been under development for the past 10+ years. It is however a big step forward for commercial metabolomics, a field that 20 years ago focused more on plants than on people.</p>
<p>Metabolism refers to the human body’s energy systems where nutrients, air and water come in so that work, heat and waste can go out. Metabolomics is a deep deep hole to explore. Metabolomic pathways in human biology rely on building blocks like amino acids and proteins, carbohydrates and sugars, lipids and fatty acids, and last, nucleotides and enzymes that are coordinators for gene expression and chemical reactions in the body.</p>
<p>Biolyz references 125 biomarkers that are relevant to athletic performance, a number that scratches the surface of what’s actually going on biochemically. Mass spectrometry, the detection technology used by Biolyz, can identify thousands of metabolites in a biosample, but achieving that precision requires controlled material handling and sample preparation. Biolyz sacrifices precision in favor of easy collection and fast turnaround while still providing adequate depth of information to describe personal attributes that are characteristic of an individual athletes’ metabolism.</p>
<p>Could something like Biolyz work for high stakes professional and college sports leagues in the U.S.? The compact geography of Europe works in favor of Biolyz’ rapid processing. The company’s academic roots also set Biolyz up to translate and commercialize what had been a research project. T</p>
<p>wo paths to create a similar service might work in American sports. Regional sports mass spec labs could spin up in places with large enough athlete and technician populations, helped by investment from deep-pocketed sports team(s) who want the competitive advantage. Alternatively, global mass spec manufacturers like Thermo Rest or Agilent might look to sports as a way to increase their public profile with the attention that partnership with a sports league offers.</p>
<p>For comparison, sample testing on drawn blood in the U.S. takes 7-14 days and returns 50-70 biomarkers. Blood test cost hundreds of dollars despite (or maybe because of) the nationwide network of medical and lab infrastructure that supports blood testing.</p>
<p>The manual collection of saliva is not especially high-tech (even though economical, rapid, refrigerated sample transport has real technical challenges). One more technical approach is to use micro- and nano-scale engineering to rapidly sample, analyze and report for metabolites in some kind of wearable form factor. Commercial and research progress into analysis of interstitial fluids is an example, led by the success of wearable continuous glucose monitor (CGMs) patches. Interstitial fluid exists below the surface of the skin. Micro-size needles can access and gather the fluid without triggering nerve cell responses. Electrodes detect the volume of glucose in the presence of enzymes and a radio transmits the data to a receiver or a phone app.</p>
<p>Jason Heikenfeld, an engineer at the University of Cincinnati, is the inventor of the sweat biomarker detector that <a href="https://www.gatorade.com/resources/how-wearables-sweat-testing-are-changing-sports">eventually became</a> Gatorade’s sweat patch. <a href="https://www.uc.edu/news/articles/2025/01/breakthrough-wearable-lets-you-tune-in-to-heart-health.html">He thinks</a> that interstitial fluid is capable of more robust biochemical analysis and has founded a company, Kilele Health, to develop the technology. University of Pittsburgh researchers <a href="https://www.futurity.org/antibody-test-3306782/?utm_source=rss&amp;utm_medium=rss&amp;utm_campaign=antibody-test-3306782">have created tests</a> for interstitial fluid that detect drugs (marijuana, fentanyl) and, in other circumstances, antibodies responding to infections (like COVID). These are specific electro-chemical tests that work like CGMs. Heikenfeld’s <a href="https://www.kilelehealth.com/">new startup</a> plans to develop new classes of bioaffinity sensors based on CRISPR-type enzymes for gene sequence recognition, though it will take work to extend the longevity and stability of these chemical processes in order to incorporate the new technology into a wearable.</p>
<p>What is becoming increasingly apparent is that concurrent biometric, activity and biomarker data add to a sum that is greater its parts. The <a href="https://www.nature.com/articles/s41746-025-01466-9">latest</a> Epicore sweat sensor combines electro-chemical sodium detection with skin temperature sensors and an accelerometer to measure activity-level. Borussia Dortmund uses the Biolyz biomarker panel alongside player-tracking and athlete health-performance data. Whoop, makers of a consumer biometric-sensing band, introduced a biomarker lab service to complement the algorithmic recommendations based on wearables data. Orreco, a rapid blood biomarker service for professional teams based in Ireland, <a href="https://www.sharktankblog.com/mark-cuban-backs-orreco-4m-acquisition/">will be integrating</a> its data with motion-tracking data sources from Sportradar and Data Driven Sports Analytics, an Australian computer vision company.</p>
</section>
<section id="visualizing-player-tracking-data" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-player-tracking-data">Visualizing Player Tracking Data</h3>
<p>Player tracking in sports has evolved, albeit slowly, over the fifteen years that the technology has been around. Early on, the athletes’ time and distance measurements helped to establish “training load” as an catch-all metric that accounts for the work from training and from competition that an athlete experiences. Training load would, in turn, foster a second metric called “Acute-Chronic Workload Ratio” that added (a little) context to athlete work measurement.</p>
<p>Wearable heartrate measurement systems have been around since before player tracking, and it took some time to realize how valuable biometrics are in terms of workload. I remember my first GPS running watch, <a href="https://www.dcrainmaker.com/2011/04/nike-sportwatch-gps-in-depth-review.html">a Nike-TomTom collaboration</a>, that showed time-distance only. Progress when the data consists of the speed and distance of your runs is knowing that you’ve gone faster or further, so I was always trying to go faster and further. Overuse injuries were common in my experience, like every couple of months.</p>
<p>ACWR was thought to be a way to manage injury risk but that theory did not hold up. <a href="https://www.lukebornn.com/papers/bornn_sloan_2019.pdf">Statistical analysis</a> showed that any increase in measured injuries that correlated with a high ACWR was just as likely to be the result of increased exposures to injuries (as in more training, more practices, more games) as it was to be the result of the recent high volume of athletes’ work.</p>
<p>The best current example that links player tracking to injury risk comes from sports statisticians at the University of North Carolina. Kendall Thomas and Jan Hannig presented, <a href="https://arxiv.org/abs/2503.11815">Movement Dynamics in Elite Female Soccer Athletes: The Quantile Cube Approach</a> at the last <a href="https://nessis.org">New England Symposium on Statistics in Sports</a>. The “quantile cube” is a data visualization that attempts to capture the complexity of athletes’ movement. The premise is that the wear and tear an athlete experiences increases as athletes move faster and change direction more frequently. Game tracking data is especially useful because the higher stakes (compared to practice or training) should correspond to maximum (or at least higher) exertion.</p>
<div class="columns">
<div class="column">
<p><img src="cube2.png" height="200"></p>
</div><div class="column">
<p><img src="cube1.png" height="200"></p>
</div>
</div>
<p>The paper, the methods and the visual presentation suggest that more exploratory analysis with player tracking data is called for. Thomas and Hannig show player tracking averages for half-games, consistent with their objective to show macro-level trends throughout a season of games. Player tracking data is typically measured at between 10-30 frames per second, meaning that lots of information is lost when half-games are the standard for precision.</p>
<p>The opposite extreme is to display each data point and see the patterns that emerge in high-density data visualization for player tracking data. For example, this is what one weekend of NFL games worth of pass receiver tracking looks like (from <a href="https://www.kaggle.com/competitions/nfl-big-data-bowl-2026-analytics/data">2026 Big Data Bowl data</a>).</p>
<p><span width="720"><img src="chart2.png" class="img-fluid" alt="https://observablehq.com/d/ceef7c78a05a8380"></span></p>
<p>One further benefit from exploratory data visualization for player tracking data should be as a stepping stone toward synthetic data for athlete biomechanics. If visual methods can get close to representing athlete movement signatures with something that can be easily inspected, it should make it possible to gain confidence in sythetic data that generates realistic athlete movement patterns. Synthetic data is, I think, important for increasing the volume of data shared throughout sports, something that should improve causal analysis between biomechanics and injuries.</p>
</section>
<section id="womens-research-update" class="level3">
<h3 class="anchored" data-anchor-id="womens-research-update">Womens Research Update</h3>
<p>US Soccer <a href="https://www.nbcnews.com/sports/soccer/us-soccer-uswnt-kang-institute-rcna248320">announced</a> a $30 million grant from Michelle Kang to create the Kang Institute, a global hub for womens athletic research. The institute’s “first study will focus on the needs of players by targeting research around injury prevention, mental health, workload management, menstrual health, and the transition from youth to elite competition,” which seems like a lot, according the NBC News reporting. The anticipated work products will be research and documenting best practices based on the research, along with an education mission.</p>
<p>The initiative has the unprecedented objective of sharing the research work products with competing nations and teams. Lex Chalat, director of Soccer Forward Foundation, told NBC News, “We want to support other countries in developing their best practices and developing and understanding how to raise the bar in their country as well.”</p>
<p>Georgie Brunvels is now the research innovation lead for US Soccer. She is a respected voice in womens’ sports and research, 0 USWNT coach Emma Hayes at Chelsea FC and <a href="https://pubmed.ncbi.nlm.nih.gov/38198788/">with Jill Ellis and Dawn Scott</a> on the 2019 USWNT World Cup victory.</p>
<p>The idea to document best practices is something that KI has in common with FAIR. FAIR stands for the Female, woman and/or girl Athlete Injury pRevention group organized by the International Olympic Committee. The <a href="https://bjsm.bmj.com/content/59/22/1546">FAIR Consensus recommendations</a> got input from 109 authors who participated in an eight-step process. The primary prevention recommendations are shown below.</p>
<p><img src="recommendations.png" class="img-fluid" width="720"></p>
<p>It is also worth mentioning that the Wu Tsai Human Performance Alliance <a href="https://humanperformance.stanford.edu/farm2025/highlights">held its Female Athlete Research Meeting</a> last month at Stanford. According to presenter Emily Kraus, FARM started as a weekly meeting among Stanford’s Wu Tsai group who worked on women’s sports. This was the first time that the Stanford FARM group opened up the conversation to a broader audience. Four hundred attended.</p>
<p>Discussing the research in settings like the FARM meeting is at least as important as doing the research. The enthusiasm and intelligence on display in the researchers’ work was impressive, as were the helpful, insightful questions and thoughts posed by attendees and panelists. Progress is in hand and underway across the collective at FARM and at Wu Tsai.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/newsletter\.bradstenger\.com");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>